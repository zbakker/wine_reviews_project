---
title: "Wine Reviews Statistical Analysis"
output:
  pdf_document: default
  html_document: default
  word_document: default
---


This is a brief introduction to summary statistics for the project of creating a model for determining the best value wine based on price and points from Wine Spectator reviews.

### Description of Variables

After performing data clean up, the dataset contains 120,975 observations of 12 variables. They are:  

* __X__ - unique identifier  
* __country__ - the country of origin of the wine  
* __continent__ - the countinent of origin of the wine  
* __province__ - the province of origin of the wine  
* __region_1__ - the wine growing region of the wine  
* __winery__ - the winery that created the wine  
* __title__ - the name of the wine  
* __year__ - the vintage of the wine  
* __variety__ - the variety of the wine  
* __points__ - the points awarded by a Wine Spectator reviewer  
* __price__ - the price in USD of the wine per bottle  
* __value__ - the points awarded to the wine per USD  

### Summary Statistics  

* All wine-producing continents are represented, with North America the most-represented continent with 54,589 observations. Asia is least-represented with 652 observations  
* The wines reviewed come from 43 unique countries. The most-represented country is the United States with 54,265 observations and least-represented is Slovakia with 1.     
* For American wines, province typically corresponds to state. The wine-producing powerhouse state of California is the most represented of the 423 worldwide provinces in the dataset.  
* The Napa Valley of California (4475 observations) is the most commonly reviewed region of 1205 regions.  
* There are 698 distinct varieties of wine with the popular Pinot Noir (12,787) and Chardonnay(11,080) as the most commonly occurring wine varieties.

## Price  
* The distribution of price is right skewed as the median price is $25, mean price is $35.36, but there are a handful of prices that are far above average. The maximum price in the origindal dataset is $3300. The minimum price is $4. Outliers from $200 to $3300 have been removed to prevent skewing the final model.  

```{r, echo = FALSE, warning = FALSE, message = FALSE}
#Load libraries
library(dplyr)
library(tidyr)
library(stringr)
library(ggplot2)
#Load in dataset
wine_reviews <- read.csv("~/Desktop/winemag-data-130k-v2.csv", stringsAsFactors=FALSE)

#Separate year from title column
wine_reviews <- separate(wine_reviews, title, c("title", "type"), sep = "\\(")

#Remove unnecessary columns 

wine_reviews <- subset( wine_reviews, select = -c(description, type, region_2, taster_name, taster_twitter_handle, designation))

#Replace NAs with "NA"

wine_reviews[is.na(wine_reviews)] <- "NA"

#Replace blanks with "NA"

wine_reviews[wine_reviews == ""] <- "NA"

#Remove leading and trailing spaces in title column
wine_reviews$title <- str_trim(wine_reviews$title)

#Change data type of price to numeric
wine_reviews$price <- as.numeric(wine_reviews$price)

#Add value column
wine_reviews <- mutate(wine_reviews, value = (points/price))

#Add continent column
wine_reviews <- wine_reviews %>%
  mutate(continent = case_when(country %in% 
                                 c("Italy","Spain","Austria","Romania","Slovenia","Georgia","Moldova","Ukraine","Portugal","France","Hungary","Luxembourg","Serbia","Bulgaria","Switzerland","Slovakia","Germany","Armenia","Greece","Czech Republic","Croatia","England","Cyprus","Bosnia and Herzegovina","Macedonia") ~ "Europe",
                               country %in% c("Argentina","Chile","Uruguay","Brazil","Peru") ~ "South America", 
                               country %in% c("Israel","India","China","Morocco","Egypt", "Turkey", "Lebanon") ~ "Asia",
                               country %in% c("South Africa") ~ "Africa", 
                               country %in% c("Mexico", "US", "Canada") ~ "North America", 
                               country %in% c("New Zealand", "Australia") ~ "Oceania",
                               TRUE ~ "Other"))
#Remove rows where price is not recorded
wine_reviews <- subset(wine_reviews, price !="NA")
  wine_reviews %>%
  filter(price < 200) %>%
  ggplot(aes(x = price)) +
  geom_histogram(binwidth = 10) +
    ggtitle("Distribution of prices") +
    xlab("price") +
    ylab("count")
```

## Points  
* Points are awarded by Wine Spectator on a scale of 0-100. This dataset only contains wines with point assignments of 80 and up. The table below gives explanations of the points.  

Score         | Description
------------- | -------------
80-84         | Good: a solid, well-made wine
85-89         | Very good: a wine with special qualities
90-94         | Outstanding: a wine of superior character and style
95-100        | Classic: a great wine  
* The minimum points in this dataset is 80 and maximum 100.  
* The median points is 88 and mean points 88.42. 

```{r,echo = FALSE, message= FALSE}
wine_reviews %>%
  ggplot(aes(x= points)) +
  geom_histogram(binwidth = 1) +
  ggtitle("Distribution of points") +
  xlab("price") +
  ylab("count")
```
  
## Value  

Value is a function of points/price. A higher value indicates that the wine is a good purchase. When working with a dataset with a drastically large range of prices (from 4 USD to 3300 USD), and a points scale that only varies by 20 points, value is an imperfect measure. 

_I am planning on doing analysis of value further by looking at the IQR of value and focusing on the mid range to avoid massive skews from super expensive wines, but considering that this is a draft, for now I am just getting some thoughts down_

```{r, message = FALSE, echo = FALSE, warning = FALSE}
wine_reviews %>%
  filter(price < 100) %>%
  filter(continent !="Other") %>%
  ggplot(aes(x = value, color = continent)) +
  geom_density(binwidth = 10)+
  facet_wrap(~ continent) +
  ggtitle("Proportion of value by continent") 
```

